# ==============================================================================
# CMIP6 Configuration FILE 
# ==============================================================================
project_name = "cmip6"
project_version = "1.0"

#------------------------------------------------------------------------------
# == Data Reference Syntax checks
# ------------------------------------------------------------------------------

[drs.filename]
# Check FILE001
severity = "H"

[drs.directory]
# Check PATH003
severity = "H"

[drs.attributes_vs_directory]
# Check PATH001
severity = "H"

[drs.filename_vs_directory]
# Check PATH002 
severity = "H"

[file.format]
# Check FILE002
severity = "H"
expected_format = "HDF5"
expected_data_model = "NETCDF4_CLASSIC"

[file.compression]
# Check FILE003
severity = "H"
expected_complevel = 1
expected_shuffle = true


#------------------------------------------------------------------------------
# Global Attributes checks 

# ------------------------------------------------------------------------------

[global_attributes.activity_id]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "str"
is_required = true
cv_source_collection = "activity_id"

[global_attributes.creation_date]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "L"
value_type = "str"
is_required = true
cv_source_collection = "creation_date"

[global_attributes.data_specs_version]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "str"
is_required = true
cv_source_collection = "data_specs_version"

[global_attributes.description]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "M"
value_type = "str"
is_required = false
constraint = ".*"

[global_attributes.experiment_id]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "str"
is_required = true
cv_source_collection = "experiment_id"

[global_attributes.experiment]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
# GL: We can switch the CV constraint to free-text or other easily if preferred.
severity = "M"
value_type = "str"
is_required = false
cv_source_collection = "experiment_id"
cv_source_collection_key = "description"

[global_attributes.frequency]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "str"
is_required = true
cv_source_collection = "frequency"

[global_attributes.further_info_url]
severity = "H"
value_type = "str"
is_required = true


[global_attributes.grid_label]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "str"
is_required = true
cv_source_collection = "grid_label"

[global_attributes.grid]
severity = "M"
value_type = "str"
is_required = true
constraint = ".*"

[global_attributes.institution_id]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "str"
is_required = true
cv_source_collection = "institution_id"

[global_attributes.institution]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "M"
value_type = "str"
is_required = false
cv_source_collection = "institution_id"
cv_source_collection_key = "description"

[global_attributes.license]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "L"
value_type = "str"
is_required = false
constraint = ".*"

[global_attributes.license_id]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "str"
is_required = true
cv_source_collection = "license_id"

[global_attributes.nominal_resolution]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "str"
is_required = true
cv_source_collection = "nominal_resolution"

[global_attributes.initialization_index]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "int"
is_required = true


[global_attributes.mip_era]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "str"
is_required = true
cv_source_collection = "mip_era"

[global_attributes.source]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
# GL: We can switch the CV constraint to free-text or other easily if preferred.
severity = "L"
value_type = "str"
is_required = false
cv_source_collection = "source_id"
cv_source_collection_key = "description"

[global_attributes.source_id]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "str"
is_required = true
cv_source_collection = "source_id"

[global_attributes.title]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "L"
value_type = "str"
is_required = false
constraint = ".*"

[global_attributes.table_id]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "str"
is_required = true
cv_source_collection = "table_id"

[global_attributes.tracking_id]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "str"
is_required = true
cv_source_collection = "tracking_id"

[global_attributes.variable_id]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "str"
is_required = true
cv_source_collection = "variable_id"

[global_attributes.variant_label]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "str"
is_required = true
cv_source_collection = "variant_label"

[global_attributes.product]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "str"
is_required = true
cv_source_collection = "product"

[global_attributes.branch_method]
severity = "M"
value_type = "str"
is_required = true
constraint = ".*"

[global_attributes.branch_time]
severity = "M"
value_type = "float"
is_required = true

[global_attributes.branch_time_in_parent]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "float"
is_required = false

[global_attributes.branch_time_in_child]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "float"
is_required = false

[global_attributes.physics_index]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "int"
is_required = true


[global_attributes.realm]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "str"
is_required = true
cv_source_collection = "realm"

[global_attributes.references]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "L"
value_type = "str"
is_required = false
constraint = ".*"

[global_attributes.sub_experiment_id]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "M"
value_type = "str"
is_required = true
cv_source_collection = "experiment_id"


[global_attributes.sub_experiment]
severity = "M"
value_type = "str"
is_required = false
cv_source_collection = "experiment_id"
cv_source_collection_key = "description"

[global_attributes.parent_activity_id]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "str"
is_required = false
cv_source_collection = "activity_id"


[global_attributes.parent_experiment_id]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "str"
is_required = false
cv_source_collection = "experiment_id"

[global_attributes.parent_mip_era]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "str"
is_required = false
cv_source_collection = "mip_era"

[global_attributes.parent_source_id]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "str"
is_required = false
cv_source_collection = "source_id"


[global_attributes.parent_time_units]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "str"
is_required = false
constraint = "^days since [0-9]{4}-[0-9]{2}-[0-9]{2}$"
# Full CF-compliant pattern is: "^(seconds|minutes|hours|days|months|years) since [0-9]{4}-[0-9]{2}-[0-9]{2}( [0-9]{2}:[0-9]{2}:[0-9]{2}(\.[0-9]+)?)?( ?(Z|[+-][0-9]{2}:[0-9]{2}))?$"

[global_attributes.parent_variant_label]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "str"
is_required = false
cv_source_collection = "variant_label"


[global_attributes.conventions]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
attribute_name = "Conventions"
severity = "H"
value_type = "str"
is_required = true
cv_source_collection = "conventions"


[global_attributes.contact]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "M"
value_type = "str"
is_required = false
constraint = ".*@.*"

[global_attributes.realization_index]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "int"
is_required = true


[global_attributes.forcing_index]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "H"
value_type = "int"
is_required = true


[global_attributes.c3s_disclaimer]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "M"
value_type = "str"
is_required = false
constraint = ".*"

[global_attributes.source_type]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "M"
value_type = "str"
is_required = true
cv_source_collection = "source_type"

[global_attributes.comment]
# Checks ATTR001 ATTR002 ATTR003 ATTR004
severity = "L"
value_type = "str"
is_required = false
constraint = ".*"


# ==============================================================================
# == Geophysical variable metadata checks
# ==============================================================================

[variable.existence]
severity = "H"

[variable.type]
severity = "H"

[variable.dimensions]
severity = "H"

[variable.bnds_vertices]
severity = "H"

[variable.shape_bounds]
# uniquement bounds value consistency
severity = "H"

[variable.time_checks]
# time_range_vs_filename + time_bounds
severity = "H"

# ==============================================================================
# == Variable attributes checks
# ==============================================================================

[variable.attributes.units]
severity = "H"

[variable.attributes.long_name]
severity = "M"

[variable.attributes.standard_name]
severity = "H"

[variable.attributes.cell_methods]
severity = "M"

[variable.attributes.cell_measures]
severity = "M"

[variable.attributes.description]
severity = "L"

# ==============================================================================
# == Coordinates checks
# ============================================================================
[coordinates.auxiliary]
severity = "H"

[coordinates.bounds]
severity = "H"

[coordinates.properties]
severity = "H"

[coordinates.time.squareness]
# Check TIME001
severity = "H"
calendar = ""
ref_time_units = ""
frequency = { subhr = "30m" }


# ==============================================================================
# == Metadata Consistency Checks
# ==============================================================================


[consistency_checks.variant_label]
severity = "H"

[consistency_checks.filename_vs_attributes]
# Check ATTR005 
severity = "H"

[consistency_checks.experiment_details]
# Check ATTR007 
severity = "H"

[consistency_checks.institution_details]
# Check ATTR009 
severity = "H"

[consistency_checks.source_details]
# Check ATTR010 
severity = "H"

[consistency_checks.freq_tableid]
# Check ATTR008 
severity = "H"


# ==============================================================================
# == Mappings for frequency/table_id Consistency Checks
# ==============================================================================
[frequency_table_id_mapping]
AERday = ["day"]
AERhr = ["1hr"]
AERmon = ["mon"]
AERmonZ = ["mon"]
Aclim = ["monClim"]
Amon = ["mon", "monC", "monClim"]
AmonExtras = ["mon"]
CF3hr = ["3hrPt"]
CFday = ["day"]
CFmon = ["mon"]
CFsubhr = ["subhrPt"]
cf3hr = ["3hr"]
cfDay = ["day"]
cfMon = ["mon"]
cfOff = ["mon"]
cfSites = ["3hr", "6hr", "subhr"]
day = ["day"]
dayExtras = ["day"]
E1hr = ["1hr", "1hrPt"]
E1hrClimMon = ["1hrCM"]
E3hr = ["3hr"]
E3hrPt = ["3hrPt"]
E6hrZ = ["6hr", "6hrPt"]
Eday = ["day"]
EdayZ = ["day"]
Emon = ["mon"]
EmonZ = ["mon"]
Esubhr = ["subhrPt"]
Eyr = ["yr", "yrPt"]
HOMAL3hrPt = ["3hrPt", "3hr"]
HOMALmon = ["mon"]
HOMEPmon = ["mon"]
HOMOImon = ["mon"]
IyrAnt = ["yr"]
IyrGre = ["yr"]
ImonAnt = ["mon"]
ImonGre = ["mon"]
LIclim = ["monClim"]
LImon = ["mon"]
Lclim = ["monClim"]
Lmon = ["mon"]
Oclim = ["monClim", "monC"]
Oday = ["day"]
Odec = ["dec"]
OIclim = ["monClim"]
OImon = ["mon"]
Omon = ["mon"]
OmonExtras = ["mon"]
Oyr = ["yr"]
OyrExtras = ["yr"]
SIday = ["day"]
SImon = ["mon", "monPt"]
sites = ["subhr"]
3hr = ["3hr", "3hrPt"]
3hrCurt = ["3hr"]
3hrMlev = ["3hr"]
3hrPlev = ["3hr"]
3hrSlev = ["3hr"]
6hrLev = ["6hr", "6hrPt"]
6hrPlev = ["6hr"]
6hrPlevPt = ["6hr", "6hrPt"]
